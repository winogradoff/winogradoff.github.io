<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Метод Гаусса-Жордана для нахождения обратной матрицы &middot; Иван Виноградов</title>
        <meta name="description" content="">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.15" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://winogradoff.github.io/css/normalize.css">
        <link rel="stylesheet" href="https://winogradoff.github.io/css/highlight.css">
        <link rel="stylesheet" href="https://winogradoff.github.io/css/style.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    </head>
    <body>
        

<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter35599795 = new Ya.Metrika({
                    id: 35599795,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/35599795" style="position:absolute; left:-9999px;" alt="" /></div></noscript>




        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a title="Главная" href="https://winogradoff.github.io/">Главная</a>
                            </h1>
                        
                        <a class="button-square" href="https://winogradoff.github.io/index.xml" target="_blank"><i class="fa fa-rss"></i></a>
                        
                            <a class="button-square button-social hint--top" data-hint="Twitter" title="Twitter" href="https://twitter.com/ivan_vinogradov" target="_blank">
                                <i class="fa fa-twitter"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Github" title="Github" href="https://github.com/winogradoff" target="_blank">
                                <i class="fa fa-github-alt"></i>
                            </a>
                        
                        
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="VK" title="VK" href="https://vk.com/iwish" target="_blank">
                                <i class="fa fa-vk"></i>
                            </a>
                        
                    </div>

                    <ul class="site-nav">
                        
    <li class="site-nav-item">
        <a title="Бложик" href="/post/">Бложик</a>
    </li>

    <li class="site-nav-item">
        <a title="Автор" href="/page/about/">Автор</a>
    </li>

                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container" itemscope="" itemtype="http://schema.org/BlogPosting">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Метод Гаусса-Жордана для нахождения обратной матрицы</h1>
    
    <p class="post-date">
        <span><time datetime="03.03.2016" itemprop="datePublished">03.03.2016</time></span>

        

    </p>
</header>


        <div class="post-content clearfix" itemprop="articleBody">
    

    <p>Программирование графических процессоров на Nvidia CUDA. Начало.</p>

<p>Первая лабораторная работа — нахождение обратной матрицы.</p>

<p>Пока вспомним алгоритм на Python:</p>

<pre><code class="language-python">from copy import deepcopy
import sys


def words():
    &quot;&quot;&quot;
    read the words
    &quot;&quot;&quot;
    for line in sys.stdin:
        for word in line.split():
            yield word


def new_empty(n):
    &quot;&quot;&quot;
    create a new empty matrix
    &quot;&quot;&quot;
    return [x[:] for x in [[0.0] * n] * n]


def pivotize(mat_a):
    &quot;&quot;&quot;
    move the largest items in the column on the diagonal
    &quot;&quot;&quot;
    mat_a = deepcopy(mat_a)
    size = len(mat_a)
    for j in range(size):
        row = max(range(j, size), key=lambda i: abs(mat_a[i][j]))
        if j != row:
            mat_a[j], mat_a[row] = mat_a[row], mat_a[j]
    return mat_a


def invert(mat_a):
    mat_a = deepcopy(mat_a)
    n = len(mat_a)

    for i in range(n):
        mat_a[i] += [int(i == j) for j in range(n)]

    mat_a = pivotize(mat_a)

    # move forward
    for i in range(n):
        first = mat_a[i][i]
        # divide the line items on the leading element
        for j in range(i, n * 2):
            mat_a[i][j] /= first
        # zero values below the leading element
        for x in range(i + 1, n):
            first = mat_a[x][i]
            for y in range(i, n * 2):
                mat_a[x][y] -= first * mat_a[i][y]

    # move back
    for i in reversed(range(n)):
        # zero values above the leading element
        for x in reversed(range(0, i)):
            first = mat_a[x][i]
            for y in reversed(range(n * 2)):
                mat_a[x][y] -= first * mat_a[i][y]

    # cut the left part
    for i in range(n):
        mat_a[i] = mat_a[i][n:]

    return mat_a


def main():
    n = int(input())
    mat_a = new_empty(n)
    w = words()
    for i in range(n):
        for j in range(n):
            mat_a[i][j] = float(next(w))

    result = invert(mat_a)
    for i in range(n):
        for j in range(n):
            print('{:15.10f}'.format(round(result[i][j], 10)), end=' ')
        print()


if __name__ == '__main__':
    main()

</code></pre>

</div>

        <footer class="post-footer clearfix">
    

    

</footer>


        


        
    <div class="comments">
        <div id="vk_comments"></div>
        <script type="text/javascript" src="//vk.com/js/api/openapi.js?121"></script>
        <script type="text/javascript">
            VK.init({apiId:  5312204 , onlyWidgets: true});
        </script>
        <script type="text/javascript">
            VK.Widgets.Comments("vk_comments", {limit: 5, width: "600", attach: false});
        </script>
        <style>
            #vk_comments, #vk_comments iframe {
                width: 100% !important;
            }
        </style>
    </div>


    </article>
</div>

            </div>
        </div>

				

        <script src="https://winogradoff.github.io/js/jquery-1.11.3.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
        <script src="https://winogradoff.github.io/js/jquery.fitvids.js"></script>
        <script src="https://winogradoff.github.io/js/scripts.js"></script>
    </body>
</html>

